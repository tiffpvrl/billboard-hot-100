# The Billboard Hot 100 #1 Songs: What the Top Tells Us About the Evolution of Music

```{r}
library(tidyverse)
library(lubridate)
library(scales)
library(redav)
library(ggplot2)
library(ggrepel)
library(GGally)
library(vcd)
library(ggmosaic)
library(ggalluvial)
library(patchwork)

billboard <- read_csv("data/billboard_clean.csv", show_col_types = FALSE)
```

## üéµ "You're Still The One" üéµ

Have you ever listened to a song so good you just had to play it over and over again... for weeks? Here, we ask ourselves what that might look like in the Billboard Hot 100. Since the list is updated weekly, it is totally possible for a song to show up across multiple weeks in the span of a year. The question is: how often does that occur every decade?

### Unique Songs that Hit #1 Across Decades

```{r}
#updating billboard to include a column for year and decade
billboard_updated <- billboard |>
  mutate(
    date_clean = as.Date(.data$date),  # Convert POSIXct to Date to help render
    year = lubridate::year(date_clean),  # Extract year
    decade = floor(year / 10) * 10
  ) |>
  select(-date) |>  # Remove old date column
  rename(date = date_clean)  # Rename back to date


week_level <- billboard_updated |>
  # Create a vector of Date objects, one for each week the song was #1.
  # map2() applies a function to (date, weeks_at_number_one) row-by-row.
  # seq.Date() generates weekly sequences like: date, date+7, date+14, ...
  mutate(week_dates = map2(
    .data$date, 
    weeks_at_number_one,
    ~ seq.Date(as_date(.x), by = "week", length.out = .y)
  )) |>
  # Expand the list-column `week_dates` so each row becomes one weekly observation.
  unnest(cols = c(week_dates)) |>
  rename(chart_date = week_dates) |>
  # Extract additional useful time components from the chart week
  mutate(
    year = year(chart_date),
    week_of_year = isoweek(chart_date),
    song_id = paste0(song, " ‚Äî ", artist)
  ) |>
  arrange(chart_date)

# Summary: number of unique #1 songs per year
songs_per_year <- billboard_updated |>
  group_by(year) |>
  summarise(unique_no1 = n_distinct(paste0(song, " ‚Äî ", artist)), .groups = "drop")
```

How many different songs hit #1 in 1975 vs. 2015?

```{r}
# Print numbers for 1975 vs 2015
val_1975 <- songs_per_year |> filter(year == 1975) %>% pull(unique_no1)
val_2015 <- songs_per_year |> filter(year == 2015) %>% pull(unique_no1)
cat("Unique #1 songs in 1975:", ifelse(length(val_1975)==0, NA, val_1975), "\n")
cat("Unique #1 songs in 2015:", ifelse(length(val_2015)==0, NA, val_2015), "\n")
```

That‚Äôs a huge drop. My guess? With streaming, viral trends, and global platforms like TikTok, a single breakout hit can dominate for months instead of passing the crown every week like songs often did in the past.

To see this trend more clearly, I visualize how long songs stay at #1 using a boxplot across decades.

```{r}
# Plot 1: Box plot of weeks at #1 across decades
# Ensure each song has a single decade (counts the first decade it shows up in)
billboard_unique <- billboard_updated |>
  group_by(song) |>
  summarize(decade = first(decade), .groups = "drop")

# Prepare weeks_by_song + decade

weeks_by_song <- billboard_updated |>
  distinct(song, artist, weeks_at_number_one) |>
  mutate(weeks_at_number_one = as.integer(weeks_at_number_one))

weeks_with_decade <- weeks_by_song |>
  left_join(billboard_unique, by = "song") |>
  mutate(decade = factor(decade))  # ensure decade is categorical

# Boxplot of weeks at #1 by decade
p_box <- ggplot(weeks_with_decade, aes(x = decade, y = weeks_at_number_one)) +
  geom_boxplot(outlier.size = 1, varwidth = TRUE, fill = "pink3") +
  labs(
    title = "Distribution of Weeks at #1 by Decade",
    x = "Decade",
    y = "Weeks at #1"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

print(p_box)
```
As expected from the 1950s through the 1990s, the median #1 song stayed at the top for only about 2 weeks. Lots of turnover, lots of variety.

Starting in the 2000s, the median creeps upward‚Äîsongs begin hanging onto the top spot a bit longer on average. This tracks with the rise of digital downloads, early streaming, and algorithm-driven discovery.

Extreme outliers (those mega-hits that stay #1 for 10, 12, 16+ weeks) slowly increase from the 1950s through the 1990s, showing that ‚Äúdominant hits‚Äù were becoming a bigger part of the chart long before streaming arrived.

Even with only five years of data, the 2020s already show seven outlier songs, the most of any decade so far. This suggests the most concentrated chart dominance we‚Äôve ever seen‚Äîexactly what you'd expect in a hyper-viral, algorithm-powered music world.

## üéµ‚ÄúDon‚Äôt Stop the Music‚Äùüéµ

###The Reign of Marathon #1 Hits

Some songs don‚Äôt just hit #1‚Äîthey move in, unpack their bags, and make themselves comfortable. These marathon hits linger at the top of the Billboard Hot 100 for weeks, sometimes months, becoming the soundtrack of entire seasons.

After seeing how outliers in the boxplot grew more extreme over time, I wanted to dig deeper:
Which songs dominated the longest, and how has that changed across decades?

To answer that, I looked at two things:
- The top 10 longest-running #1 songs of all time
- The single longest-running #1 song from each decade

```{r}
# Identify marathon hits (10+ weeks)
song_runs <- billboard_updated |>
  distinct(song, artist, weeks_at_number_one, year, decade) |>
  mutate(
    song_id = paste0(song, " ‚Äî ", artist),
    weeks_at_number_one = as.integer(weeks_at_number_one)
  )

top10_alltime <- song_runs |>
  arrange(desc(weeks_at_number_one)) |>
  slice_head(n = 10)

longest_per_decade <- song_runs |>
  group_by(decade) |>
  slice_max(weeks_at_number_one, n = 1, with_ties = FALSE) |>
  ungroup()

marathon_hits <- song_runs |>
  mutate(type = ifelse(weeks_at_number_one >= 10, "marathon", "typical"))
```

```{r}
top10_alltime
```

```{r}
longest_per_decade
```

The biggest takeaway isn‚Äôt that all long-running hits are modern‚Äîit‚Äôs that the ceiling jumped dramatically in the streaming era.

Earlier decades topped out around 10 weeks. The 1990s broke through that barrier, and the 2010s‚Äì2020s shattered it.

Streaming didn‚Äôt just reshape music consumption‚Äîit supercharged chart dominance.

After identifying the marathon hits (songs staying at #1 for 10+ weeks), I also wondered whether they tended to break through at certain times of the year. Do dominant songs arrive with the summer heat? The back-to-school lull? The holiday season?

```{r}
# Plot 2: Bar Chart of Marathon Hits by Month
# Count marathon hits per month
marathon_month_counts <- marathon_hits_only |>
  count(month)

# Bar chart of marathon hits by month
ggplot(marathon_month_counts, aes(x = month, y = n)) +
  geom_col(fill = "lightsteelblue2", color = "black", width = 0.9) +
  labs(
    title = "Month When Marathon Hits First Reached #1",
    subtitle = "Songs with 10+ consecutive weeks at #1",
    x = "Month",
    y = "Number of Marathon Hits"
  ) +
  theme_minimal(base_size = 14)
```

Surprisingly, the seasonality story isn‚Äôt as predictable as you‚Äôd think:

- April and November lead the pack with 6 marathon hits each

- November kind of makes sense‚Äîholiday listening often propels songs into the new year

- April is the real wildcard with no obvious cultural explanation

- December, the peak holiday season, produced only 3 marathon hits

And overall?
- There‚Äôs no single ‚Äúmagic month.‚Äù Dominance depends more on cultural moments and viral momentum than the calendar.



### One Week Wonders Across Decades

While looking and investigating marathons which is a small proportion of the data thought we would be able to learn more from looking into one week wonder where a song charted only for one week. Wanted to first look what percentage of the songs only charted for one week.

```{r}
# Calculate percentage of #1 songs with only 1 week at the top
one_week_pct <- weeks_by_song |>
  summarise(
    one_week_count = sum(weeks_at_number_one == 1, na.rm = TRUE),
    total_songs = n(),
    pct = one_week_count / total_songs * 100
  )

one_week_pct
```

That means roughly 1 in 3 #1 hits were ‚Äúone-week wonders,‚Äù topping the chart briefly before being replaced.

```{r}
# Compute summary per decade
one_week_by_decade <- billboard_updated |>
  distinct(song, artist, decade, weeks_at_number_one) |>   # one row per song
  group_by(decade) |>
  summarise(
    total_songs = n(),
    one_week_count = sum(weeks_at_number_one == 1),
    pct_one_week = one_week_count / total_songs * 100
  ) |>
  arrange(decade)

one_week_by_decade

one_week_by_year <- billboard_updated |>
  distinct(song, artist, year, weeks_at_number_one) |> 
  group_by(year) |>
  summarise(
    total_songs = n(),
    one_week_count = sum(weeks_at_number_one == 1),
    pct_one_week = one_week_count / total_songs * 100
  ) |>
  arrange(year)

one_week_by_decade$decade <- factor(one_week_by_decade$decade, 
                                    levels = sort(unique(one_week_by_decade$decade)))
one_week_by_year$year <- as.integer(one_week_by_year$year)
```

```{r}
p_decade <- ggplot(one_week_by_decade, aes(x = decade, y = pct_one_week)) +
  geom_line(size = 1.2, color = "indianred4", group = 1) +
  geom_point(size = 3, color = "indianred4") +
  scale_x_discrete(drop = FALSE) +
  labs(
    title = "One-Week Wonders per Decade",
    x = "Decade",
    y = "% of Songs with Only 1 Week at #1"
  ) +
  theme_minimal()

p_year <- ggplot(one_week_by_year, aes(x = year, y = pct_one_week)) +
  geom_line(size = 1, color = "plum") +
  geom_point(size = 1.5, color = "plum") +
 geom_text(
    aes(label = year),
    nudge_y = 1,        # move label slightly up from the point
    size = 3,           # text size
    check_overlap = TRUE
  ) +
  labs(
    title = "One-Week Wonders per Year",
    x = "Year",
    y = "% of Songs with Only 1 Week at #1"
  ) +
  theme_minimal()

p_decade
```
```{r}
p_year
```

The 2020s represent unprecedented chart volatility - the highest one-week wonder rate in history, likely due to:
- Streaming algorithms favoring new releases
- Viral TikTok trends creating rapid chart movements
- Increased competition and shorter attention spans

Interesting because I would have assumed that due to the increased marathon runners in the streaming era we would have less one week wonders in 2020s. We see that in some years like 2002, 2014 with no one week wonders.

The mid-1970s mystery: Why did 1975-1977 have such extreme turnover, even higher than today? This predates streaming and warrants investigation.

The 1980s-1990s stability: This era had the most "dominant" #1 hits - songs could hold the top spot for many consecutive weeks (think Whitney Houston, Boyz II Men).

Cyclical patterns: The U-shape suggests chart dynamics aren't linear - they respond to cultural and technological shifts in waves.

------------------------------------------------------------------------

## üéµ "I've Been Afraid of Changing" üéµ

The world looks different now in 2025 than it did in 1950, and so did the music we listen to. Here, we explore how music has changed across decades. Do they sound different musically? Are we using different instruments than we did 70 years ago? Are we listening to more singer-songwriters than bands?

### Instrumentation and Sound Evolution

```{r, results=FALSE}
song_vars <- billboard_updated |>
  select(song, decade, bpm, energy, danceability, happiness, loudness_d_b,
         acousticness, length_sec, instrumental_length_sec)
song_vars <- song_vars |> drop_na()

pca_all <- prcomp(song_vars[, 3:ncol(song_vars)], scale. = TRUE)
round(pca_all$rotation, 5)
pc_scores_all <- pca_all$x
rownames(pc_scores_all) <- song_vars$song 
pca_summary <- summary(pca_all)
round(rbind(pc_scores_all, NA, pca_summary$importance), 5)
```

```{r}
billboard_20th <- song_vars |> filter(decade < 2000)
billboard_21st <- song_vars |> filter(decade >= 2000)

song_vars_20th <- billboard_20th |> 
  select(bpm, energy, danceability, happiness, loudness_d_b,
         acousticness, length_sec, instrumental_length_sec)

song_vars_21st <- billboard_21st |> 
  select(bpm, energy, danceability, happiness, loudness_d_b,
         acousticness, length_sec, instrumental_length_sec)
```

```{r}
draw_biplot(song_vars_20th, label_size = 2, point_size = 0.2, point_color = "lightsteelblue2", vector_colors = "maroon", point_labels = FALSE) +
  ggtitle("Biplot: Songs Before 2000")
```

```{r}
draw_biplot(song_vars_21st, label_size = 3, point_size = 0.2, point_color = "lightsteelblue2", vector_colors = "maroon", point_labels = FALSE) +
  ggtitle("Biplot: Songs From 2000 Onward")
```

Earlier decades show a tightly linked cluster of danceability, energy, and loudness‚Äîa sign that upbeat songs tended to be uniformly bright, energetic, and dance-friendly. Think disco, classic pop, 80s synths, and power ballads. BPM and happiness also aligned, suggesting that ‚Äúfast = cheerful‚Äù was a common formula for a hit. Acousticness sat far from the energy cluster‚Äîacoustic songs rarely overlapped with dance-heavy tracks.

This reflects a time when genres were more distinct, and production styles followed clearer rules.

Post 2000s, danceability no longer correlates with acousticness‚Äîmodern songs blend ‚Äúdance-friendly‚Äù rhythms with acoustic textures (think Ed Sheeran or folk-pop crossovers). BPM and happiness no longer travel together; a fast song doesn‚Äôt have to feel bright or positive (hello, hyperpop sadness or moody EDM).

Put simply: modern hits don‚Äôt follow the old blueprints anymore. Genre fluidity, bedroom pop production, and algorithm-driven trends allow features to recombine in ways that were rare before 2000.

### Evolution of Genre Across Decades

When I think 1960s-70s, I think of rock as the defining music genre of that time. When I think 2010-2020s, I think of indie, hip-hop, and pop. But will this reflect in the Billboard Hot 100? To test my hypothesis, I create a heatmap of the proportion of genres of #1 songs for each decade. Since songs could have more than one genre, I define the proportion of a genre as how many times a genre appeared in that decade divided by the total number of songs that appeared in that decade.

```{r}
# Genre representation

# Separate rows with multiple genres
genres_billboard <- billboard_updated |>
  separate_rows(discogs_genre, sep=";") |>
  mutate(genre_sep = str_trim(discogs_genre)) |>
  filter(genre_sep != "")

# Count songs by decade and genre
genre_counts <- genres_billboard |>
  group_by(decade, genre_sep) |>
  summarise(n_genre = n(), .groups = "drop")

# Count unique songs per decade
decade_totals <- billboard_updated |>
  group_by(decade) |>
  summarise(n_total = n(), .groups = "drop")

# Calculate proportion of genre per decade
genre_prop <- genre_counts |>
  left_join(decade_totals, by = "decade") |>
  mutate(proportion = n_genre/n_total)

# Heatmap data
heatmap_genre <- genre_prop |>
  select(decade, genre_sep, proportion)

# Ordering by average proportion for genres
genre_avg <- heatmap_genre |>
  group_by(genre_sep) |>
  summarise(avg_prop = mean(proportion, na.rm = TRUE)) |>
  arrange(avg_prop)

heatmap_genre <- heatmap_genre |>
  mutate(genre_sep = factor(genre_sep, levels = genre_avg$genre_sep))

# Create the heatmap
ggplot(heatmap_genre, aes(x = decade, y = genre_sep, fill = proportion)) +
  geom_tile() +
  scale_fill_gradient(low="lightsteelblue1", high = "royalblue4", name = "Genre Proportion") +
  # scale_fill_distiller(palette = "Blues", direction = 1, name = "Genre Proportion") +
  scale_x_continuous(breaks=unique(heatmap_genre$decade)) +
  labs(
    title = "Heatmap of Genre per Decade",
    subtitle = "In decreasing order of average proportion",
    x = "Decade",
    y = "Genre") +
  theme_minimal()
```

The heat map above shows us that Pop has always been a popular (haha) genre, which is not surprising. It lost to Rock as the genre with the most #1 songs in the 60s and 70s, though. We also see that Hip Hop as a genre did not even show up in any of the #1 songs until the 1980s, and since then has consistently charted, with the peak being in the 2000s. Almost opposite to Hip Hop is Rock, which was prominent in the 50s to 80s, but quickly lost its popularity from the 1990s onwards.

### Solo/Duo/Group Artists vs Featured Collaborations

Just like I picture the 60s and 70s to be the defining decades for Rock, I also picture the 60s and 70s to be the defining decades for bands. Names like "The Beatles" and "Fleetwood Mac" - both bands - come to mind as prominent artists of that era, whereas names like "Taylor Swift" and "Ariana Grande" - solo artists - come to mind as prominent artists of the era we are in right now. To test this hypothesis, I create a mosaic plot that shows us the distribution of artist structure (group, duo, solo) and featured collaborations per decade.

```{r}
# Solo artists vs groups vs collaborations

# Separating between solo, duo and group
# Separating between feature vs no feature
bb_artist <- billboard_updated |>
  mutate(
    artist_type = case_when(
      artist_structure %in% c(0, 0.5) ~ "Group",
      artist_structure %in% c(1, 1.5) ~ "Solo",
      artist_structure %in% c(2, 2.5) ~ "Duo"
    ),
    has_feature = ifelse(artist_structure %% 1 == 0.5, "With Feature", "No Feature"),
    artist_type = factor(artist_type, levels = c("Group", "Duo", "Solo")),
    era_detailed = case_when(
      decade < 1990 ~ "Before 1990", 
      decade >= 1990 & decade < 2010 ~ "1990-2009",
      decade >= 2010 ~ "2010-2025"
      ),
    era_detailed = factor(era_detailed, levels = c("Before 1990", "1990-2009", "2010-2025"))
  )

# Stacked bar chart with artist structure
structure_chart <- ggplot(data = bb_artist, aes(x = decade, fill = artist_type)) +
  geom_bar(position = "fill") +
  scale_x_continuous(breaks = unique(bb_artist$decade), trans = "reverse") +
  scale_fill_manual(
    values = c("Solo" = "lightsteelblue2", "Duo" = "lightsteelblue3", "Group" = "lightsteelblue4"),
    name = "Artist Structure"
  ) +
  labs(
    title = "How Has Artist Structure Changed Across Decades?",
    x = "Decade",
    y = "Song Proportion"
  ) +
  coord_flip()


# Stacked bar chart with artist feature
feature_chart <- ggplot(data = bb_artist, aes(x = era_detailed, fill = has_feature)) +
  geom_bar(position = "fill") +
  scale_fill_manual(
    values = c("With Feature" = "indianred4", "No Feature" = "indianred3"),
    name = "Feature"
  ) +
  labs(
    title = "How Have Music Collaborations Changed?",
    x = "Era",
    y = "Proportion of Features"
  )

structure_chart + feature_chart
```

These two stacked bar charts confirm my hypothesis. Firstly, it shows us that group artists are slowly becoming less popular every decade. In the 1960s, group artists made up most of the #1 songs, where now, it is dominated by solo artists. Secondly, it shows us that virtually no featured collaborations made it to #1 before the 1990s, which is consistent with a [2018 report from The Economist](https://www.economist.com/graphic-detail/2018/02/02/popular-music-is-more-collaborative-than-ever) telling us that collaboration in music is a relatively recent phenomena.

------------------------------------------------------------------------

## üéµ "Say My Name, Say My Name" üéµ

The songs we listen to might sound different now, but could it be because of the people behind the curtain? Here, we pay homage to the artists, songwriters, and producers working hard behind the scenes to give us the songs that eventually show up as #1 in the Billboard Hot 100. How have they changed across decades?

### Top Artists Over the Years

Our data spans 1950 to 2025, so I am interested in looking at the top artists of all time (artists that have the most songs at #1 in the Billboard Hot 100) and what years they were popular. For instance, were The Beatles only popular for a certain time or do they have songs that are #1 even now?

```{r}
# Get top 20 artists
top_20_artists <- billboard_updated |>
  count(artist, sort = TRUE) |>
  slice_head(n = 20) |>
  pull(artist)

# Get first and last year for each artist
artist_timeline <- billboard_updated |>
  filter(artist %in% top_20_artists) |>
  group_by(artist) |>
  summarise(
    first_year = min(year, na.rm = TRUE),
    last_year = max(year, na.rm = TRUE),
    n_songs = n()
  ) |>
  arrange(first_year, desc(n_songs)) |>
  mutate(artist = factor(artist, levels = rev(artist)))

# Get individual songs for points
artist_songs <- billboard_updated |>
  filter(artist %in% top_20_artists) |>
  select(artist, year) |>
  left_join(artist_timeline |> select(artist), by = "artist") |>
  mutate(artist = factor(artist, levels = levels(artist_timeline$artist)))

# Create timeline plot
ggplot(artist_timeline, aes(y = artist)) +
  geom_segment(aes(x = first_year, xend = last_year, yend = artist),
               alpha = 1, size = 0.5, color = "black") +
  geom_point(data = artist_songs, aes(x = year, y = artist), 
             color = "royalblue4", alpha = 0.5, size = 4) +
  labs(
    title = "Active Years for Top 20 Artists with #1 Songs",
    subtitle = "Each dot represents a song that charted as #1",
    x = "Year",
    y = "Artist"
  ) +
  theme_minimal() +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  )
```

The chart above takes the top 20 artists of all time and marks the first year and the most recent year in which their song hit #1. While most of these artists are not popular for more than 10 years, there are some interesting anomalies. Mariah Carey, for example, first hit #1 in the mid 1990s and last hit #1 in 2019, although it looks she was more consistently popular in the 1990s, falling off after 2000. The Beatles and The Supremes have almost the opposite story, with their reign of popularity only taking up a few years despite having many more songs hit #1.

### Are #1 Artists & Songwriters Becoming More Diverse?

With more and more opportunities being presented to artists of color and women artists over the years, I would imagine there being a stark difference between the gender and race distribution of #1 artists now than in 1950. I test this hypothesis by creating two mosaic plots exploring the effect of gender and race on era (defined as before 1990 and after 1990).

```{r}
# Artist Gender and Race
artist_data <- billboard_updated |>
  mutate(
    gender = case_when(
      artist_male == 0 ~ "All Female",
      artist_male == 1 ~ "All Male",
      artist_male == 2 | artist_male == 3 ~ "Mixed Gender"
    ),
    race = case_when(
      artist_white == 0 ~ "Not White",
      artist_white == 1 ~ "White",
      artist_white == 2 ~ "Mixed Race"
    ),
    era_detailed = case_when(
      decade < 1990 ~ "Before 1990", 
      decade >= 1990 ~ "After 1990"
      ),
    era_detailed = factor(era_detailed, levels = c("Before 1990", "After 1990")),
    gender = factor(gender, levels = c("All Male", "All Female", "Mixed Gender"))
  ) |>
  select(artist, decade, gender, race, era_detailed) |>
  distinct()

# define grayscale palette
shades <- c("Mixed Race" = "plum", 
            "Not White" = "lightsteelblue2", 
            "White" = "indianred4")

vcd::mosaic(~era_detailed + gender + race,
       data = artist_data,
       direction = c("v", "v", "h"),
       main = "Artist Gender and Race Interaction",
       highlighting = "race",
       highlighting_fill = shades,
       main_gp = gpar(fontsize = 12),
       labeling_args = list(
         gp_labels = gpar(fontsize = 5),   # Adjust category label font size
         gp_varnames = gpar(fontsize = 7) # Adjust variable names font size
       ))
```

The mosaic plot above confirms my hypothesis and shows us that, before 1990, "All Male" seemed to take up the biggest proportion of artists, with more than 2/3 of these male artists being white. "All Female" and "Mixed Gender" artists had similar proportions, but both were still overwhelmingly white.

After 1990, it still looks like "All Male" artists dominate #1 compared to "All Female" and "Mixed Gender" artists, but the distribution of race makes a dramatic 180. Now, half of the male artists are not white, compared to before 1990 where not white artists only made up less than 1/3 of all male artists. This is a huge improvement for the distribution of race in our #1 artists!

```{r}
# Top Songwriters
songwriter_data <- billboard_updated |>
  mutate(
    gender = case_when(
      songwriter_male == 0 ~ "All Female",
      songwriter_male == 1 ~ "All Male",
      songwriter_male == 2 | songwriter_male == 3 ~ "Mixed Gender"
    ),
    race = case_when(
      songwriter_white == 0 ~ "Not White",
      songwriter_white == 1 ~ "White",
      songwriter_white == 2 ~ "Mixed Race"
    ),
    era_detailed = case_when(
      decade < 1990 ~ "Before 1990", 
      decade >= 1990 ~ "After 1990"
      ),
    era_detailed = factor(era_detailed, levels = c("Before 1990", "After 1990")),
    gender = factor(gender, levels = c("All Male", "All Female", "Mixed Gender"))
  ) |>
  select(songwriters, gender, race, era_detailed) |>
  drop_na() |>
  distinct()

# define grayscale palette
shades <- c("Mixed Race" = "plum", 
            "Not White" = "lightblue", 
            "White" = "indianred4")

vcd::mosaic(~era_detailed + gender + race,
       data = songwriter_data,
       direction = c("v", "v", "h"),
       main = "Songwriter Gender and Race Interaction",
       highlighting = "race",
       highlighting_fill = shades,
       main_gp = gpar(fontsize = 12),
       labeling_args = list(
         gp_labels = gpar(fontsize = 5),   # Adjust category label font size
         gp_varnames = gpar(fontsize = 7) # Adjust variable names font size
       ))
```

For songwriters, it looks like before 1990, it was dominated by songwriting groups of all white males.

After 1990, however, we once again see a big improvement. We now have a more even split between songwriting groups that are all male and mixed gender (all female groups are extremely rare, apparently). Within both male and mixed gender groups, we see a more even split between mixed race, not white, and white songwriters. Interestingly, both all male and mixed gender groups are dominated by mixed race songwriters!

From the two mosaic plots above, we can conclude that we are indeed seeing a big jump in diversity in the artists and songwriters behind our #1 songs in the Billboard Hot 100. A win for the music industry!
